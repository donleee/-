# 拼多多利润分析系统 - 完整发布包

## 🚀 系统特点

- **跨平台支持**: Windows、Mac、Linux全平台兼容
- **多种运行模式**: 图形界面、Web界面、命令行三种模式
- **完整功能**: 单品分析、批量分析、历史管理、趋势分析
- **数据导出**: 支持Excel格式报告导出
- **便携性强**: 支持独立可执行文件和便携版本

## 📦 文件说明

### 核心程序文件
- `start.py` - 智能启动器（推荐使用）
- `simple_gui.py` - 简化GUI版本（兼容性更好）
- `gui_app.py` - 完整GUI版本（功能丰富）
- `web_app.py` - Web界面版本
- `main.py` - 命令行版本

### 打包和部署
- `package.py` - 自动打包工具
- `build_windows.bat` - Windows打包脚本
- `build_mac.sh` - Mac/Linux打包脚本
- `requirements.txt` - Python依赖包列表

### 项目核心
- `src/` - 核心计算引擎和业务逻辑
- `config/` - 配置文件
- `data/` - 历史数据存储目录

## 🎯 使用方法

### 方法一：一键启动（推荐）
```bash
python start.py
```
或
```bash
python3 start.py
```

### 方法二：选择特定界面

#### 图形界面（GUI）
```bash
python simple_gui.py    # 简化版，兼容性更好
python gui_app.py       # 完整版，功能丰富
```

#### Web界面
```bash
python web_app.py
# 或
python main.py --mode web
```

#### 命令行界面
```bash
python main.py
```

### 方法三：生成独立可执行文件

#### Windows系统
```cmd
python package.py
# 或直接运行
build_windows.bat
```

#### Mac/Linux系统
```bash
python package.py
# 或直接运行
chmod +x build_mac.sh
./build_mac.sh
```

## ⚙️ 环境要求

### 基本要求
- Python 3.6+ 
- 操作系统: Windows 7+、macOS 10.12+、Ubuntu 16.04+

### 依赖包（自动安装）
- matplotlib >= 3.5.0
- pandas >= 1.3.0  
- openpyxl >= 3.0.9
- streamlit >= 1.0.0 (Web界面)
- tkinter (GUI界面，Python内置)

## 📊 功能详解

### 1. 单品利润分析
- 输入商品基本信息（售价、成本、运费等）
- 输入订单数据（销量、退货数量、成交订单等）
- 自动计算利润、利润率、保本价格等关键指标
- 支持广告费用和退款率分析

### 2. 批量分析
- 支持CSV文件批量导入
- 一次性分析多个商品
- 生成对比图表
- 批量导出结果

### 3. 历史记录管理
- 自动保存每次分析结果
- 支持按型号、利润等条件搜索
- 历史数据可视化趋势分析
- 支持历史记录导出和清理

### 4. 趋势分析
- 价格-利润关系分析
- 可视化图表展示
- 帮助定价决策

## 🔧 故障排除

### 常见问题

#### 1. GUI界面无法启动
**解决方案**:
- 使用 `python simple_gui.py` 启动简化版本
- 或使用 `python main.py --mode web` 启动Web版本
- 或使用 `python main.py` 启动命令行版本

#### 2. 依赖包安装失败
**解决方案**:
```bash
# 升级pip
pip install --upgrade pip

# 手动安装依赖
pip install matplotlib pandas openpyxl streamlit

# 或使用国内镜像
pip install -r requirements.txt -i https://pypi.tuna.tsinghua.edu.cn/simple/
```

#### 3. 打包失败
**解决方案**:
```bash
# 安装PyInstaller
pip install pyinstaller

# 清理缓存后重新打包
rm -rf build/ dist/ *.spec
python package.py
```

#### 4. macOS权限问题
**解决方案**:
```bash
# 给脚本执行权限
chmod +x build_mac.sh
chmod +x 启动.sh

# 如果遇到安全限制，在系统偏好设置-安全性与隐私中允许
```

### 系统兼容性

| 操作系统 | GUI界面 | Web界面 | 命令行 | 打包支持 |
|---------|---------|---------|--------|----------|
| Windows 10/11 | ✅ | ✅ | ✅ | ✅ |
| macOS 10.12+ | ⚠️ | ✅ | ✅ | ✅ |
| Linux Ubuntu | ⚠️ | ✅ | ✅ | ✅ |

注：⚠️ 表示可能需要额外配置GUI环境

## 📋 CSV文件格式

批量分析支持的CSV文件格式：

```csv
model_name,price,cost,other_cost,shipping_fee,commission_rate,sales_volume,return_quantity,deal_orders,net_deal_orders,ad_deal_price,ad_enabled
SKU-001,100,50,5,10,3,100,10,95,85,2.0,True
SKU-002,120,60,6,12,4,150,20,140,120,2.5,True
SKU-003,80,40,4,8,2.5,80,5,75,70,1.5,False
```

### 字段说明
- `model_name`: 商品型号
- `price`: 商品售价
- `cost`: 商品成本  
- `other_cost`: 其他成本
- `shipping_fee`: 运费
- `commission_rate`: 平台扣点(%)
- `sales_volume`: 销量
- `return_quantity`: 退货数量
- `deal_orders`: 成交订单数
- `net_deal_orders`: 净成交订单数
- `ad_deal_price`: 广告出价
- `ad_enabled`: 是否启用广告(True/False)

## 🧮 计算公式

### 基础指标
- **退款率** = 退货数量 ÷ 销量 × 100%
- **秒退率** = (成交订单 - 净成交订单) ÷ 成交订单 × 100%

### 成本计算
- **商品成本** = 分析订单数 × (商品成本 + 其他成本)
- **运费成本** = 分析订单数 × 运费
- **平台扣点** = 收入 × 平台扣点率
- **广告费用** = 分析订单数 × 每笔广告出价
- **退款广告损失** = 每笔广告出价 × 退款率
- **总成本** = 商品成本 + 运费成本 + 平台扣点 + 广告费用 + 退款广告损失

### 利润计算
- **总收入** = 分析订单数 × 商品售价
- **总利润** = 总收入 - 总成本
- **利润率** = (总利润 ÷ 总收入) × 100%

### 保本分析
- **保本广告出价** = 售价×(1-扣点率) - 商品成本 - 其他成本 - 运费
- **最高广告投入** = 保本广告出价 × (1 - 退款率)
- **保本ROI** = 保本售价 ÷ 保本广告出价

## 📞 技术支持

如遇到问题或需要技术支持，请：

1. 查看本文档的故障排除部分
2. 检查系统环境和依赖包版本
3. 尝试不同的运行模式
4. 保留错误信息截图以便问题排查

## 📄 版本信息

- **当前版本**: v1.0.0
- **发布日期**: 2025年7月12日
- **兼容性**: Python 3.6+ / Windows 7+ / macOS 10.12+ / Linux
- **更新内容**: 
  - 完整的图形界面
  - 多平台打包支持
  - 增强的计算引擎
  - 完善的历史记录管理

---

**祝您使用愉快！💰**